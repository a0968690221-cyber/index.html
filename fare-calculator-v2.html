<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ç°¡æ˜“è»Šè³‡èˆ‡å›é‡‘è¨ˆç®—å™¨</title>
  <style>
    :root{
      --bg:#f6f7fb; --card:#ffffff; --text:#222; --muted:#666; --brand:#3b82f6; --ok:#16a34a; --warn:#ca8a04; --danger:#dc2626;
      --shadow:0 10px 20px rgba(0,0,0,.08), 0 2px 6px rgba(0,0,0,.05);
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans",sans-serif}
    .wrap{max-width:1100px;margin:32px auto;padding:0 16px}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:20px}
    h1{font-size:22px;margin:0 0 12px}
    p.desc{color:var(--muted);margin:0 0 18px}
    .grid{display:grid;gap:14px}
    @media(min-width:980px){.grid{grid-template-columns:1.2fr .8fr}}
    label{display:block;font-weight:600;margin:0 0 6px}
    input[type="number"], select{width:100%;padding:12px 12px;border:1px solid #e5e7eb;border-radius:12px;background:#fff;font-size:16px}
    input[type="number"]:focus, select:focus{outline:none;border-color:var(--brand);box-shadow:0 0 0 4px rgba(59,130,246,.15)}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .btn{display:inline-flex;align-items:center;gap:8px;background:var(--brand);color:#fff;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer}
    .btn.secondary{background:#1118270d;color:#111827}
    .btn.ghost{background:#fff;border:1px dashed #cbd5e1;color:#334155}
    .btn:active{transform:translateY(1px)}
    .results{margin-top:18px;display:grid;gap:12px}
    .pill{display:inline-block;background:#1118270d;color:#111827;padding:6px 10px;border-radius:999px;font-size:12px}
    .kpi{display:flex;align-items:baseline;gap:10px}
    .kpi .value{font-size:28px;font-weight:800}
    .kpi small{color:var(--muted)}
    .breakdown{border:1px dashed #e5e7eb;border-radius:12px;padding:12px}
    .list{margin:0;padding:0;list-style:none}
    .list li{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px dotted #eee}
    .list li:last-child{border-bottom:0}
    .foot{margin-top:8px;color:var(--muted);font-size:13px}
    .tr{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;align-items:center;padding:8px 10px;background:#f8fafc;border-radius:10px}
    .tr b{font-size:16px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>ğŸš• ç°¡æ˜“è»Šè³‡èˆ‡å¸æ©Ÿå›é‡‘è¨ˆç®—å™¨</h1>
      <p class="desc">è¦å‰‡ï¼šèµ·è·³ <b>$80</b> ãƒ» æ¯å…¬é‡Œ <b>$15</b> ãƒ» æ¯åˆ†é˜ <b>$3</b> ãƒ» <b>è¶…é 20 å…¬é‡Œ</b> æ¯å…¬é‡ŒåŠ  <b>$10</b>ã€‚å›é‡‘ï¼šä»¥å®Œæ•´è»Šè³‡ç‚ºåŸºç¤ï¼Œæ¯æ»¿ $100 å› $10ï¼ˆç„¡æ¢ä»¶æ¨å»ï¼‰ï¼Œè‡ªå®¶ +20ï¼æ”¯æ´ +30ã€‚</p>

      <div class="grid">
        <div class="card" style="padding:16px">
          <div class="pill">æ¨¡å¼ Aï¼šç”¨è·é›¢ï¼‹æ™‚é–“ä¼°è»Šè³‡ä¸¦ç®—å›é‡‘</div>
          <div class="grid" style="margin-top:10px">
            <div>
              <label for="km">è¡Œè»Šè·é›¢ï¼ˆå…¬é‡Œï¼‰</label>
              <input id="km" type="number" step="0.1" min="0" placeholder="ä¾‹å¦‚ï¼š6.7" />
            </div>
            <div>
              <label for="min">è¡Œè»Šæ™‚é–“ï¼ˆåˆ†é˜ï¼‰</label>
              <input id="min" type="number" step="1" min="0" placeholder="ä¾‹å¦‚ï¼š27" />
            </div>
          </div>
          <div class="row" style="margin-top:14px">
            <div>
              <label for="driver">å¸æ©Ÿé¡å‹</label>
              <select id="driver">
                <option value="self">è‡ªå®¶</option>
                <option value="support">æ”¯æ´</option>
              </select>
            </div>
            <div>
              <label for="rounding">é‡‘é¡é¡¯ç¤º</label>
              <select id="rounding">
                <option value="none">ä¸å››æ¨äº”å…¥</option>
                <option value="nearest">å››æ¨äº”å…¥åˆ°å…ƒ</option>
                <option value="ten">å››æ¨äº”å…¥åˆ° 10 å…ƒ</option>
              </select>
            </div>
          </div>

          <div style="margin-top:14px;display:flex;gap:10px;flex-wrap:wrap">
            <button class="btn" id="calc">è¨ˆç®—ï¼ˆæ¨¡å¼ Aï¼‰</button>
            <button class="btn secondary" id="demo1">ç¤ºä¾‹ â‘ ï¼ˆ6.7km / 27åˆ†ï¼‰</button>
            <button class="btn secondary" id="demo2">ç¤ºä¾‹ â‘¡ï¼ˆ28.8km / 28åˆ†ï¼‰</button>
          </div>

          <hr style="margin:20px 0;border:none;border-top:1px dashed #e5e7eb">
          <div class="pill">æ¨¡å¼ Bï¼šå¸æ©Ÿå›å‚³ä¹˜å®¢å¯¦ä»˜é‡‘é¡ï¼ˆæˆªåœ–ï¼‰â†’ ç›´æ¥ç®—å›é‡‘</div>
          <div class="row" style="margin-top:10px">
            <div>
              <label for="amt">ä¹˜å®¢å¯¦ä»˜é‡‘é¡ï¼ˆ$ï¼‰</label>
              <input id="amt" type="number" step="1" min="0" placeholder="ä¾‹å¦‚ï¼š1005 æˆ– 684" />
            </div>
            <div style="display:flex;align-items:flex-end">
              <button class="btn ghost" id="calcByAmt">è¨ˆç®—å›é‡‘ï¼ˆæ¨¡å¼ Bï¼‰</button>
            </div>
          </div>
          <div class="foot">æ¨¡å¼ B æœƒåŒæ™‚åˆ—å‡ºã€Œè‡ªå®¶ï¼æ”¯æ´ã€å…©ç¨®å›é‡‘èˆ‡å¸æ©Ÿå¯¦æ”¶ï¼›æ­¤æ¨¡å¼ä¸éœ€è¦è¼¸å…¥è·é›¢èˆ‡æ™‚é–“ã€‚</div>
        </div>

        <div class="card" style="padding:16px">
          <div class="pill">çµæœ</div>
          <div class="results">
            <div class="kpi">
              <div class="value" id="fare">â€”</div>
              <small>ä¹˜å®¢è»Šè³‡ï¼ˆå«é•·é€”åŠ æˆï¼‰</small>
            </div>
            <div class="kpi">
              <div class="value" id="kickback">â€”</div>
              <small>å¸æ©Ÿå›é‡‘ï¼ˆä¾é¡å‹ï¼‰</small>
            </div>
            <div class="kpi">
              <div class="value" id="driverNet">â€”</div>
              <small>å¸æ©Ÿå¯¦æ”¶ï¼ˆè»Šè³‡ âˆ’ å›é‡‘ï¼‰</small>
            </div>

            <div class="breakdown">
              <ul class="list" id="detail"></ul>
            </div>

            <div class="breakdown" id="byAmtBox" style="display:none">
              <div class="pill" style="margin-bottom:8px">ç”±æˆªåœ–é‡‘é¡æ¨å›é‡‘</div>
              <div class="tr"><span>è‡ªå®¶å›é‡‘</span><b id="byAmtSelf">â€”</b><small id="byAmtSelfNet" class="foot"></small></div>
              <div class="tr"><span>æ”¯æ´å›é‡‘</span><b id="byAmtSupport">â€”</b><small id="byAmtSupportNet" class="foot"></small></div>
            </div>

            <div id="note" class="foot"></div>
          </div>
        </div>
      </div>

    </div>
  </div>

<script>
(function(){
  const el = (id)=>document.getElementById(id);
  const fmt = (n)=> n===null? 'â€”' : new Intl.NumberFormat('zh-Hant-TW', {minimumFractionDigits:0, maximumFractionDigits:1}).format(n);
  const rounders = {
    none: (v)=>v,
    nearest: (v)=> Math.round(v),
    ten: (v)=> Math.round(v/10)*10
  };

  function compute(){
    const km = parseFloat(el('km').value);
    const min = parseFloat(el('min').value);
    const driver = el('driver').value; // self | support
    const rounding = el('rounding').value;

    if(isNaN(km) || isNaN(min)){
      alert('è«‹è¼¸å…¥è·é›¢èˆ‡æ™‚é–“');
      return;
    }

    const base = 80;
    const perKm = 15;
    const perMin = 3;
    const longAdd = Math.max(0, km - 20) * 10;

    const subtotal = base + (km * perKm) + (min * perMin);
    const fareTotalRaw = subtotal + longAdd;
    const fareTotal = rounders[rounding](fareTotalRaw);

    // å›é‡‘è¦å‰‡ï¼ˆæœ€çµ‚ç‰ˆï¼‰ï¼šä»¥å®Œæ•´è»Šè³‡ç‚ºåŸºç¤ï¼Œæ¯æ»¿ 100 å…ƒå› 10 å…ƒï¼ˆç„¡æ¢ä»¶æ¨å»ï¼‰ï¼›è‡ªå®¶ +20ï¼›æ”¯æ´ +30
    const percent = Math.floor(fareTotalRaw / 100) * 10;
    const kickback = (driver === 'self') ? (percent + 20) : (percent + 30);
    const driverNet = fareTotal - kickback;

    el('fare').textContent = `$ ${fmt(fareTotal)}`;
    el('kickback').innerHTML = `$ ${fmt(kickback)} <span class="badge ${driver==='self'?'slate':'amber'}">${driver==='self'?'è‡ªå®¶':'æ”¯æ´'}</span>`;
    el('driverNet').textContent = `$ ${fmt(driverNet)}`;

    const d = [
      ['èµ·è·³', `$ ${fmt(base)}`],
      ['æ™‚é–“è²»ï¼ˆ$3/åˆ†ï¼‰', `${min} åˆ† ï¼ $ ${fmt(min*perMin)}`],
      ['è·é›¢è²»ï¼ˆ$15/å…¬é‡Œï¼‰', `${km.toFixed(1)} å…¬é‡Œ ï¼ $ ${fmt(km*perKm)}`],
      ['è¶… 20 å…¬é‡ŒåŠ æˆï¼ˆ$10/å…¬é‡Œï¼‰', `${(km>20? (km-20).toFixed(1):'0.0')} å…¬é‡Œ ï¼ $ ${fmt(longAdd)}`],
      ['å°è¨ˆï¼ˆæœªå¥—ç”¨é¡¯ç¤ºå››æ¨äº”å…¥ï¼‰', `$ ${fmt(fareTotalRaw)}`]
    ];
    el('detail').innerHTML = d.map(([k,v])=>`<li><span>${k}</span><b>${v}</b></li>`).join('');

    el('byAmtBox').style.display = 'none';

    let note = '';
    if(km===6.7 && min===27){
      note = 'ç¤ºä¾‹â‘ ï¼š80 + 27Ã—3 + 6.7Ã—15 = 261.5ã€‚';
    } else if (km===28.8 && min===28){
      note = 'ç¤ºä¾‹â‘¡ï¼š80 + 28Ã—3 + 28.8Ã—15 = 596ï¼›é•·é€”åŠ æˆ 8.8Ã—10 = 88ï¼›åˆè¨ˆ $684ã€‚å›é‡‘ï¼(684â†’æ¯ç™¾å›10â†’60) + æ”¯æ´åŠ æˆ30 ï¼ 90ã€‚';
    } else {
      note = 'å‚™è¨»ï¼šå›é‡‘ï¼ä»¥å®Œæ•´è»Šè³‡ç‚ºåŸºç¤ï¼Œæ¯æ»¿ 100 å…ƒå› 10 å…ƒï¼ˆç„¡æ¢ä»¶æ¨å»ï¼‰ï¼Œè‡ªå®¶ +20ï¼æ”¯æ´ +30ã€‚';
    }
    el('note').textContent = note;
  }

  function computeByAmount(){
    const amount = parseFloat(el('amt').value);
    if(isNaN(amount)){
      alert('è«‹è¼¸å…¥ä¹˜å®¢å¯¦ä»˜é‡‘é¡');
      return;
    }

    // ä»¥æˆªåœ–é‡‘é¡ä½œç‚ºå®Œæ•´è»Šè³‡åŸºç¤
    const fareTotalRaw = amount;
    const percent = Math.floor(fareTotalRaw / 100) * 10; // æ¯æ»¿ 100 å› 10ï¼ˆç„¡æ¢ä»¶æ¨å»ï¼‰
    const kickSelf = percent + 20;
    const kickSup = percent + 30;

    el('fare').textContent = `$ ${fmt(amount)}`;
    el('kickback').textContent = 'â€”';
    el('driverNet').textContent = 'â€”';
    el('detail').innerHTML = `<li><span>ä»¥æˆªåœ–é‡‘é¡ç‚ºåŸºç¤</span><b>$ ${fmt(amount)}</b></li><li><span>æ¯ç™¾å›é‡‘ï¼ˆç„¡æ¢ä»¶æ¨å»ï¼‰</span><b>$ ${fmt(percent)}</b></li>`;

    el('byAmtSelf').textContent = `$ ${fmt(kickSelf)}`;
    el('byAmtSupport').textContent = `$ ${fmt(kickSup)}`;
    el('byAmtSelfNet').textContent = `å¸æ©Ÿå¯¦æ”¶ï¼ˆè‡ªå®¶ï¼‰ï¼ $ ${fmt(amount - kickSelf)}`;
    el('byAmtSupportNet').textContent = `å¸æ©Ÿå¯¦æ”¶ï¼ˆæ”¯æ´ï¼‰ï¼ $ ${fmt(amount - kickSup)}`;
    el('byAmtBox').style.display = '';

    el('note').textContent = 'æ¨¡å¼ Bï¼šç”±æˆªåœ–é‡‘é¡ç›´æ¥è¨ˆç®—å›é‡‘èˆ‡å¸æ©Ÿå¯¦æ”¶ï¼ˆè‡ªå®¶ï¼æ”¯æ´ï¼‰ã€‚';
  }

  // Demo buttons
  el('demo1').addEventListener('click', ()=>{
    el('km').value = 6.7; el('min').value = 27; el('driver').value = 'self'; el('rounding').value='ten'; compute();
  });
  el('demo2').addEventListener('click', ()=>{
    el('km').value = 28.8; el('min').value = 28; el('driver').value = 'support'; el('rounding').value='none'; compute();
  });

  el('calc').addEventListener('click', compute);
  el('calcByAmt').addEventListener('click', computeByAmount);
})();
</script>
</body>
</html>
